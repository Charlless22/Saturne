window.saturne||(window.saturne={},window.saturne.scriptsLoaded=!1),window.saturne.scriptsLoaded||(window.saturne.init=function(){window.saturne.load_list_script()},window.saturne.load_list_script=function(){if(!window.saturne.scriptsLoaded){var t=void 0,e=void 0;for(t in window.saturne)for(e in window.saturne[t].init&&window.saturne[t].init(),window.saturne[t])window.saturne[t]&&window.saturne[t][e]&&window.saturne[t][e].init&&window.saturne[t][e].init();window.saturne.scriptsLoaded=!0}},window.saturne.refresh=function(){var t=void 0,e=void 0;for(t in window.saturne)for(e in window.saturne[t].refresh&&window.saturne[t].refresh(),window.saturne[t])window.saturne[t]&&window.saturne[t][e]&&window.saturne[t][e].refresh&&window.saturne[t][e].refresh()},$(document).ready(window.saturne.init)),window.saturne.button={},window.saturne.button.init=function(){window.saturne.button.event()},window.saturne.button.event=function(){$(document).on("click",".wpeo-button:submit",window.saturne.button.addLoader)},window.saturne.button.addLoader=function(){window.saturne.loader.display($(this)),$(this).toggleClass("button-blue button-disable")},window.saturne.dropdown={},window.saturne.dropdown.init=function(){window.saturne.dropdown.event()},window.saturne.dropdown.event=function(){$(document).on("keyup",window.saturne.dropdown.keyup),$(document).on("keypress",window.saturne.dropdown.keypress),$(document).on("click",".wpeo-dropdown:not(.dropdown-active) .dropdown-toggle:not(.disabled)",window.saturne.dropdown.open),$(document).on("click",".wpeo-dropdown.dropdown-active .dropdown-content",function(t){t.stopPropagation()}),$(document).on("click",".wpeo-dropdown.dropdown-active:not(.dropdown-force-display) .dropdown-content .dropdown-item",window.saturne.dropdown.close),$(document).on("click",".wpeo-dropdown.dropdown-active",function(t){window.saturne.dropdown.close(t),t.stopPropagation()}),$(document).on("click","body",window.saturne.dropdown.close)},window.saturne.dropdown.keyup=function(t){27===t.keyCode&&window.saturne.dropdown.close()},window.saturne.dropdown.keypress=function(t){var e=localStorage.currentString||"",n=localStorage.keypressNumber?+localStorage.keypressNumber:0;e+=t.keyCode,++n,localStorage.setItem("currentString",e),localStorage.setItem("keypressNumber",n),9<n&&(localStorage.setItem("currentString",""),localStorage.setItem("keypressNumber",0)),"9897114114101108114111108108"===e&&(t="-webkit-",n="transform:rotate(1turn);",e="transition:4s;",document.head.innerHTML+="<style>body{"+t+n+t+e+n+e)},window.saturne.dropdown.open=function(t){var n=$(this),o=n.find("[data-fa-i2svg]"),e={},i=void 0;window.saturne.dropdown.close(t,$(this)),n.attr("data-action")?(window.saturne.loader.display(n),n.get_data(function(t){for(i in e)t[i]||(t[i]=e[i]);window.saturne.request.send(n,t,function(t,e){n.closest(".wpeo-dropdown").find(".dropdown-content").html(e.data.view),n.closest(".wpeo-dropdown").addClass("dropdown-active"),o&&window.saturne.dropdown.toggleAngleClass(o)})})):(n.closest(".wpeo-dropdown").addClass("dropdown-active"),o&&window.saturne.dropdown.toggleAngleClass(o)),t.stopPropagation()},window.saturne.dropdown.close=function(t){var n=$(this);$(".wpeo-dropdown.dropdown-active:not(.no-close)").each(function(){var t=$(this),e={close:!0};n.trigger("dropdown-before-close",[t,n,e]),e.close&&(t.removeClass("dropdown-active"),e=$(this).find(".dropdown-toggle").find("[data-fa-i2svg]"))&&window.saturne.dropdown.toggleAngleClass(e)})},window.saturne.dropdown.toggleAngleClass=function(t){t.hasClass("fa-caret-down")||t.hasClass("fa-caret-up")?t.toggleClass("fa-caret-down").toggleClass("fa-caret-up"):t.hasClass("fa-caret-circle-down")||t.hasClass("fa-caret-circle-up")?t.toggleClass("fa-caret-circle-down").toggleClass("fa-caret-circle-up"):t.hasClass("fa-angle-down")||t.hasClass("fa-angle-up")?t.toggleClass("fa-angle-down").toggleClass("fa-angle-up"):(t.hasClass("fa-chevron-circle-down")||t.hasClass("fa-chevron-circle-up"))&&t.toggleClass("fa-chevron-circle-down").toggleClass("fa-chevron-circle-up")},window.saturne.keyEvent={},window.saturne.keyEvent.init=function(){window.saturne.keyEvent.event()},window.saturne.keyEvent.event=function(){$(document).on("keydown",window.saturne.keyEvent.modalActions),$(document).on("keyup",".url-container",window.saturne.keyEvent.checkUrlFormat),$(document).on("click",".modal-active:not(.modal-container)",window.saturne.modal.closeModal)},window.saturne.keyEvent.modalActions=function(t){"Escape"===t.key&&$(this).find(".modal-active .modal-close .fas.fa-times").first().click(),"Enter"===t.key&&(t.preventDefault(),$("input, textarea").is(":focus")?$("textarea:focus").val($("textarea:focus").val()+"\n"):$(this).find(".modal-active .modal-footer .wpeo-button").not(".button-disable").first().click())},window.saturne.keyEvent.checkUrlFormat=function(t){$(this).val().match(/[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/gi)?$(this).attr("style","border: solid; border-color: green"):0<$("input:focus").val().length&&$(this).attr("style","border: solid; border-color: red")},window.saturne.loader={},window.saturne.loader.init=function(){window.saturne.loader.event()},window.saturne.loader.event=function(){},window.saturne.loader.display=function(t){var e;t.hasClass("button-progress")?t.addClass("button-load"):(t.addClass("wpeo-loader"),e=$('<span class="loader-spin"></span>'),t[0].loaderElement=e,t.append(t[0].loaderElement))},window.saturne.loader.remove=function(t){0<t.length&&!t.hasClass("button-progress")&&(t.removeClass("wpeo-loader"),$(t[0].loaderElement).remove())},window.saturne.mediaGallery={},window.saturne.mediaGallery.init=function(){window.saturne.mediaGallery.event()},window.saturne.mediaGallery.event=function(){$(document).on("click",".clickable-photo",window.saturne.mediaGallery.selectPhoto),$(document).on("click",".save-photo",window.saturne.mediaGallery.savePhoto),$(document).on("change",".flat.minwidth400.maxwidth200onsmartphone",window.saturne.mediaGallery.sendPhoto),$(document).on("click",".clicked-photo-preview",window.saturne.mediaGallery.previewPhoto),$(document).on("input",".form-element #search_in_gallery",window.saturne.mediaGallery.handleSearch),$(document).on("click",".media-gallery-unlink",window.saturne.mediaGallery.unlinkFile),$(document).on("click",".media-gallery-favorite",window.saturne.mediaGallery.addToFavorite),$(document).on("change",".fast-upload",window.saturne.mediaGallery.fastUpload),$(document).on("click",".select-page",window.saturne.mediaGallery.selectPage)},window.saturne.mediaGallery.selectPhoto=function(t){var e=$(this).attr("value"),n=$(this).closest(".modal-content");$(this).hasClass("clicked-photo")?($(this).attr("style","none !important"),$(this).removeClass("clicked-photo"),0===$(".clicked-photo").length&&$(this).closest(".modal-container").find(".save-photo").addClass("button-disable")):(n.closest(".modal-container").find(".save-photo").removeClass("button-disable"),n.find(".clickable-photo"+e).addClass("clicked-photo"))},window.saturne.mediaGallery.savePhoto=function(t){let e=$("#media_gallery");var n=$(this).closest(".modal-container").find(".clicked-photo"),o=$(".id-container").find('input[name="token"]').val(),i=$(this).find(".from-id").val(),a=$(this).find(".from-type").val();let s=$(this).find(".from-subtype").length?$(this).find(".from-subtype").val():"";var r=$(this).find(".from-subdir").length?$(this).find(".from-subdir").val():"";let d="";0<n.length&&n.each(function(){d+=$(this).find(".filename").val()+"vVv"}),window.saturne.loader.display($(this)),window.saturne.loader.display($(".linked-medias."+s));n=window.saturne.toolbox.getQuerySeparator(document.URL);$.ajax({url:document.URL+n+"subaction=addFiles&token="+o,type:"POST",data:JSON.stringify({filenames:d,objectId:i,objectType:a,objectSubdir:r,objectSubtype:s}),processData:!1,contentType:!1,success:function(t){$(".wpeo-loader").removeClass("wpeo-loader"),e.removeClass("modal-active"),$(".linked-medias."+s).html($(t).find(".linked-medias."+s).children()),e.html($(t).find("#media_gallery").children())}})},window.saturne.mediaGallery.handleSearch=function(t){let e=$("#search_in_gallery").val();$(".center.clickable-photo").each(function(){$(this).text().trim().match(e)?$(this).show():$(this).hide()})},window.saturne.mediaGallery.sendPhoto=function(t){t.preventDefault();let o=$("#media_gallery");t=$(this).prop("files");let i=t.length,a=0,s=0,r=o.find(".from-id").val(),d=o.find(".from-type").val(),l=o.find(".from-subtype").length?o.find(".from-subtype").val():"",c=o.find(".from-subdir").length?o.find(".from-subdir").val():"",u=$('input[name="token"]').val(),h=($("#progressBar").width(0),$("#progressBarContainer").attr("style","display:block"),window.saturne.loader.display($("#progressBarContainer")),window.saturne.toolbox.getQuerySeparator(document.URL));$.each(t,function(t,e){var n=new FormData;n.append("userfile[]",e),$.ajax({url:document.URL+h+"subaction=uploadPhoto&token="+u,type:"POST",data:n,processData:!1,contentType:!1,success:function(n){a++,s+=1/i*100,$("#progressBar").animate({width:s+"%"},1),a===i&&($(".wpeo-loader").removeClass("wpeo-loader"),$("#progressBarContainer").fadeOut(800),$("#progressBarContainer").find(".loader-spin").remove(),window.saturne.loader.display(o.find(".ecm-photo-list-content")),setTimeout(()=>{o.html($(n).find("#media_gallery").children()).promise().done(()=>{var t,e;1==i&&($("#media_gallery").find(".save-photo").removeClass("button-disable"),$("#media_gallery").find(".clickable-photo0").addClass("clicked-photo")),($(n).find(".error-medias").length?(t=$(n).find(".error-medias").val(),e="",e+=JSON.parse(t).message,$(".messageErrorSendPhoto").find(".notice-subtitle").text(e),$(".messageErrorSendPhoto")):$(".messageSuccessSendPhoto")).removeClass("hidden"),$("#media_gallery").find(".from-id").attr("value",r),$("#media_gallery").find(".from-type").attr("value",d),$("#media_gallery").find(".from-subtype").attr("value",l),$("#media_gallery").find(".from-subdir").attr("value",c),$("#media_gallery").find(".wpeo-button").attr("value",r)})},800))}})})},window.saturne.mediaGallery.previewPhoto=function(t){var e=setInterval(function(){$(".ui-dialog").length&&(clearInterval(e),$(document).find(".ui-dialog").addClass("preview-photo"))},100)},window.saturne.mediaGallery.unlinkFile=function(t){t.preventDefault();t=$('input[name="token"]').val();let e=$(this).closest(".linked-medias").find(".from-subtype").length?$(this).closest(".linked-medias").find(".from-subtype").val():"";var n=$(this).closest(".media-container"),o=n.find(".file-path").val(),n=(window.saturne.loader.display(n),window.saturne.toolbox.getQuerySeparator(document.URL));$.ajax({url:document.URL+n+"subaction=unlinkFile&token="+t,type:"POST",data:JSON.stringify({filepath:o}),processData:!1,success:function(t){$(".wpeo-loader").removeClass("wpeo-loader"),$(".linked-medias."+e).html($(t).find(".linked-medias."+e).children())}})},window.saturne.mediaGallery.addToFavorite=function(t){t.preventDefault();var t=$(this).closest(".media-gallery-favorite").find(".filename").attr("value"),e=$(this).closest(".linked-medias").find(".fas.fa-star"),n=$(this).find(".far.fa-star");e.removeClass("fas"),e.addClass("far"),e.closest(".media-gallery-favorite").removeClass("favorite"),n.addClass("fas"),n.removeClass("far"),n.closest(".media-gallery-favorite").addClass("favorite"),0<t.length&&$(this).closest(".linked-medias").find(".favorite-photo").val(t)},window.saturne.mediaGallery.fastUpload=function(t){var e=$(this).prop("files");let n=$('input[name="token"]').val(),o=$("#media_gallery"),i=new FormData,a=$(this).closest(".linked-medias").find(".from-id").val(),s=$(this).closest(".linked-medias").find(".from-type").val(),r=$(this).closest(".linked-medias").find(".from-subtype").length?$(this).closest(".linked-medias").find(".from-subtype").val():"",d=$(this).closest(".linked-medias").find(".from-subdir").length?$(this).closest(".linked-medias").find(".from-subdir").val():"",l=(window.saturne.loader.display($(".linked-medias."+r)),window.saturne.toolbox.getQuerySeparator(document.URL)),c="",u=e.length,h=0;$.each(e,function(t,e){i.append("userfile[]",e),c+=e.name+"vVv",$.ajax({url:document.URL+l+"subaction=uploadPhoto&token="+n,type:"POST",data:i,processData:!1,contentType:!1,complete:function(){++h==u&&$.ajax({url:document.URL+l+"subaction=addFiles&token="+n,type:"POST",data:JSON.stringify({filenames:c,objectId:a,objectType:s,objectSubtype:r,objectSubdir:d}),processData:!1,contentType:!1,success:function(t){$(".wpeo-loader").removeClass("wpeo-loader"),o.removeClass("modal-active"),$(".linked-medias."+r).html($(t).find(".linked-medias."+r).children()),o.html($(t).find("#media_gallery").children())}})}})})},window.saturne.mediaGallery.selectPage=function(t){var e=$(".fiche").find('input[name="token"]').val(),n=$(this).closest(".wpeo-pagination").find("#pagesCounter").val();let o=$(this).closest(".wpeo-pagination").find("#containerToRefresh").val();var i=$(this).attr("value");let a=$("#"+o);var s=window.saturne.toolbox.getQuerySeparator(document.URL);$(this).hasClass("arrow")||($(this).closest(".wpeo-pagination").find(".pagination-element").removeClass("pagination-current"),$(this).closest(".pagination-element").addClass("pagination-current")),window.saturne.loader.display($("#media_gallery").find(".modal-content")),$.ajax({url:document.URL+s+"subaction=pagination&token="+e,type:"POST",data:JSON.stringify({offset:i,pagesCounter:n}),processData:!1,contentType:!1,success:function(t){$(".wpeo-loader").removeClass("wpeo-loader"),a.html($(t).find("#"+o).children())},error:function(){}})},window.eoxiaJS.menu={},window.eoxiaJS.menu.init=function(){window.eoxiaJS.menu.event()},window.eoxiaJS.menu.event=function(){$(document).on("click"," .blockvmenu",window.eoxiaJS.menu.toggleMenu),$(document).ready(function(){window.eoxiaJS.menu.setMenu()})},window.eoxiaJS.menu.toggleMenu=function(){var t=$(this).closest("#id-left").find("a.vmenu, font.vmenudisabled, span.vmenu, a.vsmenu"),e=$(this).closest("#id-left").find("div.vmenu"),n="";0<$(this).find("span.vmenu").find(".fa-chevron-circle-left").length?(t.each(function(){(n=$(this).html().split("</i>"))[1].match(/&gt;/)&&(n[1]=n[1].replace(/&gt;/,"")),$(this).attr("title",n[1]),$(this).html(n[0])}),e.css("width","30px"),e.find(".blockvmenusearch").hide(),$("span.vmenu").attr("title"," Agrandir le menu"),$("span.vmenu").html($("span.vmenu").html()),$(this).find("span.vmenu").find(".fa-chevron-circle-left").removeClass("fa-chevron-circle-left").addClass("fa-chevron-circle-right"),localStorage.setItem("maximized","false")):0<$(this).find("span.vmenu").find(".fa-chevron-circle-right").length&&(t.each(function(){$(this).html($(this).html().replace("&gt;","")+" "+$(this).attr("title"))}),e.css("width","188px"),e.find(".blockvmenusearch").show(),$("div.menu_titre").attr("style","width: 188px !important; cursor : pointer"),$("span.vmenu").attr("title"," Réduire le menu"),$("span.vmenu").html('<i class="fas fa-chevron-circle-left"></i> Réduire le menu'),localStorage.setItem("maximized","true"),$(this).find("span.vmenu").find(".fa-chevron-circle-right").removeClass("fa-chevron-circle-right").addClass("fa-chevron-circle-left"))},window.eoxiaJS.menu.setMenu=function(){var t,e,n;0<$(".blockvmenu.blockvmenufirst").length&&$(".blockvmenu.blockvmenufirst").html().match(/digiriskdolibarr|dolismq/)&&($("span.vmenu").find(".fa-chevron-circle-left").parent().parent().parent().attr("style","cursor:pointer ! important"),"false"==localStorage.maximized&&$("#id-left").attr("style","display:none !important"),"false"==localStorage.maximized&&(t="",e=$("#id-left").find("a.vmenu, font.vmenudisabled, span.vmenu, a.vsmenu"),n=$(document).find("div.vmenu"),e.each(function(){t=$(this).html().split("</i>"),$(this).attr("title",t[1]),$(this).html(t[0]),console.log(t)}),$("#id-left").attr("style","display:block !important"),$("div.menu_titre").attr("style","width: 50px !important"),$("span.vmenu").attr("title"," Agrandir le menu"),$("span.vmenu").html($("span.vmenu").html()),$("span.vmenu").find(".fa-chevron-circle-left").removeClass("fa-chevron-circle-left").addClass("fa-chevron-circle-right"),n.css("width","30px"),n.find(".blockvmenusearch").hide()),localStorage.setItem("currentString",""),localStorage.setItem("keypressNumber",0))},window.saturne.modal={},window.saturne.modal.init=function(){window.saturne.modal.event()},window.saturne.modal.event=function(){$(document).on("click",".modal-close",window.saturne.modal.closeModal),$(document).on("click",".modal-open",window.saturne.modal.openModal),$(document).on("click",".modal-refresh",window.saturne.modal.refreshModal)},window.saturne.modal.openModal=function(t){var e=$(this).find(".modal-to-open").val(),n=$(this).find(".from-id").length?$(this).find(".from-id").val():0,o=$(this).find(".from-type").length?$(this).find(".from-type").val():"",i=$(this).find(".from-subtype").length?$(this).find(".from-subtype").val():"",a=$(this).find(".from-subdir").length?$(this).find(".from-subdir").val():"";let s="";s=document.URL.match(/#/)?document.URL.split(/#/)[0]:document.URL,history.pushState({path:document.URL},"",s),$("#"+e).find(".from-id").attr("value",n),$("#"+e).find(".from-type").attr("value",o),$("#"+e).find(".from-subtype").attr("value",i),$("#"+e).find(".from-subdir").attr("value",a),$("#"+e).find(".wpeo-button").attr("value",n),$("#"+e).addClass("modal-active"),$(this).hasClass("modal-signature-open")&&window.saturne.signature.modalSignatureOpened($(this)),$(".notice").addClass("hidden")},window.saturne.modal.closeModal=function(t){($(t.target).hasClass("modal-active")||$(t.target).hasClass("modal-close")||$(t.target).parent().hasClass("modal-close"))&&($(this).closest(".modal-active").removeClass("modal-active"),$(".clicked-photo").attr("style",""),$(".clicked-photo").removeClass("clicked-photo"),$(".notice").addClass("hidden"))},window.saturne.modal.refreshModal=function(t){window.location.reload()},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.SignaturePad=e()}(this,function(){"use strict";function l(t,e,n){this.x=t,this.y=e,this.time=n||(new Date).getTime()}function o(t,e,n,o){this.startPoint=t,this.control1=e,this.control2=n,this.endPoint=o}function h(t,e){var n,o,i,a,s,r,d,l,c=this,e=e||{};function u(){l=!1===i.leading?0:Date.now(),d=null,r=n.apply(a,s),d||(a=s=null)}this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=(n=h.prototype._strokeUpdate,o=this.throttle,d=null,l=0,i=i||{},function(){var t=Date.now(),e=(l||!1!==i.leading||(l=t),o-(t-l));return a=this,s=arguments,e<=0||o<e?(d&&(clearTimeout(d),d=null),l=t,r=n.apply(a,s),d||(a=s=null)):d||!1===i.trailing||(d=setTimeout(u,e)),r}):this._strokeMoveUpdate=h.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(t){1===t.which&&(c._mouseButtonDown=!0,c._strokeBegin(t))},this._handleMouseMove=function(t){c._mouseButtonDown&&c._strokeMoveUpdate(t)},this._handleMouseUp=function(t){1===t.which&&c._mouseButtonDown&&(c._mouseButtonDown=!1,c._strokeEnd(t))},this._handleTouchStart=function(t){1===t.targetTouches.length&&(t=t.changedTouches[0],c._strokeBegin(t))},this._handleTouchMove=function(t){t.preventDefault();t=t.targetTouches[0];c._strokeMoveUpdate(t)},this._handleTouchEnd=function(t){t.target===c._canvas&&(t.preventDefault(),c._strokeEnd(t))},this.on()}return l.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1},l.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},l.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time},o.prototype.length=function(){for(var t=0,e=void 0,n=void 0,o=0;o<=10;o+=1){var i,a,s=o/10,r=this._point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),s=this._point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);0<o&&(i=r-e,a=s-n,t+=Math.sqrt(i*i+a*a)),e=r,n=s}return t},o.prototype._point=function(t,e,n,o,i){return e*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*o*(1-t)*t*t+i*t*t*t},h.prototype.clear=function(){var t=this._ctx,e=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0},h.prototype.fromDataURL=function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=new Image,i=n.ratio||window.devicePixelRatio||1,a=n.width||this._canvas.width/i,s=n.height||this._canvas.height/i;this._reset(),o.src=t,o.onload=function(){e._ctx.drawImage(o,0,0,a,s)},this._isEmpty=!1},h.prototype.toDataURL=function(t){var e;if("image/svg+xml"===t)return this._toSVG();for(var n=arguments.length,o=Array(1<n?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return(e=this._canvas).toDataURL.apply(e,[t].concat(o))},h.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},h.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},h.prototype.isEmpty=function(){return this._isEmpty},h.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),"function"==typeof this.onBegin&&this.onBegin(t)},h.prototype._strokeUpdate=function(t){var e=t.clientX,t=t.clientY,e=this._createPoint(e,t),t=this._data[this._data.length-1],t=t&&t[t.length-1],n=t&&e.distanceTo(t)<this.minDistance;t&&n||(n=(t=this._addPoint(e)).curve,t=t.widths,n&&t&&this._drawCurve(n,t.start,t.end),this._data[this._data.length-1].push({x:e.x,y:e.y,time:e.time,color:this.penColor}))},h.prototype._strokeEnd=function(t){var e,n=2<this.points.length,o=this.points[0];!n&&o&&this._drawDot(o),o&&(e=(n=this._data[this._data.length-1])[n.length-1],o.equals(e)||n.push({x:o.x,y:o.y,time:o.time,color:this.penColor})),"function"==typeof this.onEnd&&this.onEnd(t)},h.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},h.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},h.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},h.prototype._createPoint=function(t,e,n){var o=this._canvas.getBoundingClientRect();return new l(t-o.left,e-o.top,n||(new Date).getTime())},h.prototype._addPoint=function(t){var e,n=this.points;return n.push(t),2<n.length?(3===n.length&&n.unshift(n[0]),t=this._calculateCurveControlPoints(n[0],n[1],n[2]).c2,e=this._calculateCurveControlPoints(n[1],n[2],n[3]).c1,t=new o(n[1],t,e,n[2]),e=this._calculateCurveWidths(t),n.shift(),{curve:t,widths:e}):{}},h.prototype._calculateCurveControlPoints=function(t,e,n){var o=t.x-e.x,i=t.y-e.y,a=e.x-n.x,s=e.y-n.y,r=(t.x+e.x)/2,t=(t.y+e.y)/2,d=(e.x+n.x)/2,n=(e.y+n.y)/2,o=Math.sqrt(o*o+i*i),i=Math.sqrt(a*a+s*s),a=i/(o+i),s=d+(r-d)*a,o=n+(t-n)*a,i=e.x-s,a=e.y-o;return{c1:new l(r+i,t+a),c2:new l(d+i,n+a)}},h.prototype._calculateCurveWidths=function(t){var e=t.startPoint,t=t.endPoint,n={start:null,end:null},t=this.velocityFilterWeight*t.velocityFrom(e)+(1-this.velocityFilterWeight)*this._lastVelocity,e=this._strokeWidth(t);return n.start=this._lastWidth,n.end=e,this._lastVelocity=t,this._lastWidth=e,n},h.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)},h.prototype._drawPoint=function(t,e,n){var o=this._ctx;o.moveTo(t,e),o.arc(t,e,n,0,2*Math.PI,!1),this._isEmpty=!1},h.prototype._drawCurve=function(t,e,n){var o=this._ctx,i=n-e,a=Math.floor(t.length());o.beginPath();for(var s=0;s<a;s+=1){var r=s/a,d=r*r,l=d*r,c=1-r,u=c*c,h=u*c,w=h*t.startPoint.x,h=(w=(w=(w+=3*u*r*t.control1.x)+3*c*d*t.control2.x)+l*t.endPoint.x,h*t.startPoint.y),u=(h=(h=(h+=3*u*r*t.control1.y)+3*c*d*t.control2.y)+l*t.endPoint.y,e+l*i);this._drawPoint(w,h,u)}o.closePath(),o.fill()},h.prototype._drawDot=function(t){var e=this._ctx,n="function"==typeof this.dotSize?this.dotSize():this.dotSize;e.beginPath(),this._drawPoint(t.x,t.y,n),e.closePath(),e.fill()},h.prototype._fromData=function(t,e,n){for(var o=0;o<t.length;o+=1){var i=t[o];if(1<i.length)for(var a=0;a<i.length;a+=1){var s,r=i[a],d=new l(r.x,r.y,r.time),r=r.color;0===a?(this.penColor=r,this._reset(),this._addPoint(d)):a!==i.length-1&&(s=(d=this._addPoint(d)).curve,d=d.widths,s)&&d&&e(s,d,r)}else this._reset(),n(i[0])}},h.prototype._toSVG=function(){var o=this,t=this._data,e=this._canvas,n=Math.max(window.devicePixelRatio||1,1),i=e.width/n,n=e.height/n,a=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=(a.setAttributeNS(null,"width",e.width),a.setAttributeNS(null,"height",e.height),this._fromData(t,function(t,e,n){var o=document.createElement("path");isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y)||(t="M "+t.startPoint.x.toFixed(3)+","+t.startPoint.y.toFixed(3)+" C "+t.control1.x.toFixed(3)+","+t.control1.y.toFixed(3)+" "+t.control2.x.toFixed(3)+","+t.control2.y.toFixed(3)+" "+t.endPoint.x.toFixed(3)+","+t.endPoint.y.toFixed(3),o.setAttribute("d",t),o.setAttribute("stroke-width",(2.25*e.end).toFixed(3)),o.setAttribute("stroke",n),o.setAttribute("fill","none"),o.setAttribute("stroke-linecap","round"),a.appendChild(o))},function(t){var e=document.createElement("circle"),n="function"==typeof o.dotSize?o.dotSize():o.dotSize;e.setAttribute("r",n),e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("fill",t.color),a.appendChild(e)}),'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+i+" "+n+'" width="'+i+'" height="'+n+'">'),t=a.innerHTML;if(void 0===t){var s=document.createElement("dummy"),r=a.childNodes;s.innerHTML="";for(var d=0;d<r.length;d+=1)s.appendChild(r[d].cloneNode(!0));t=s.innerHTML}return"data:image/svg+xml;base64,"+btoa(e+t+"</svg>")},h.prototype.fromData=function(t){var n=this;this.clear(),this._fromData(t,function(t,e){return n._drawCurve(t,e.start,e.end)},function(t){return n._drawDot(t)}),this._data=t},h.prototype.toData=function(){return this._data},h}),window.saturne.signature={},window.saturne.signature.canvas,window.saturne.signature.buttonSignature,window.saturne.signature.init=function(){window.saturne.signature.event()},window.saturne.signature.event=function(){$(document).on("click",".signature-erase",window.saturne.signature.clearCanvas),$(document).on("click",".signature-validate",window.saturne.signature.createSignature),$(document).on("click",".auto-download",window.saturne.signature.autoDownloadSpecimen)},window.saturne.signature.modalSignatureOpened=function(t){window.saturne.signature.buttonSignature=t;var e=Math.max(window.devicePixelRatio||1,1),e=(window.saturne.signature.canvas=document.querySelector("#modal-signature"+t.attr("value")+" canvas"),window.saturne.signature.canvas.signaturePad=new SignaturePad(window.saturne.signature.canvas,{penColor:"rgb(0, 0, 0)"}),window.saturne.signature.canvas.width=window.saturne.signature.canvas.offsetWidth*e,window.saturne.signature.canvas.height=window.saturne.signature.canvas.offsetHeight*e,window.saturne.signature.canvas.getContext("2d").scale(e,e),window.saturne.signature.canvas.signaturePad.clear(),$("#signature_data"+t.attr("value")).val());window.saturne.signature.canvas.signaturePad.fromDataURL(e)},window.saturne.signature.clearCanvas=function(){$(this).closest(".modal-signature").find("canvas")[0].signaturePad.clear()},window.saturne.signature.createSignature=function(){var t=$(this).attr("value");let e=$(this).find("#zone"+t).attr("value");var n;$("#confCAPTCHA").val();let o=$(".noticeSignatureSuccess"),i=0!==t?"&signatoryID="+t:"";$(this).closest(".wpeo-modal").find("canvas")[0].signaturePad.isEmpty()||(n=$(this).closest(".wpeo-modal").find("canvas")[0].toDataURL());t=$(".modal-signature").find('input[name="token"]').val(),t=document.URL+"&action=add_signature"+i+"&token="+t;$.ajax({url:t,type:"POST",processData:!1,contentType:"application/octet-stream",data:JSON.stringify({signature:n,code:""}),success:function(t){"private"==e?(o.html($(t).find(".noticeSignatureSuccess .all-notice-content")),o.removeClass("hidden"),$(".signatures-container").html($(t).find(".signatures-container"))):window.location.reload()},error:function(){}})},window.saturne.signature.download=function(t,e){var n=document.createElement("a");n.href=t,n.setAttribute("download",e),n.click()},window.saturne.signature.autoDownloadSpecimen=function(){let n=$(this).closest(".file-generation"),o=$(".digirisk-signature-container").find('input[name="token"]').val();var t=document.URL+"&action=builddoc&token="+o;$.ajax({url:t,type:"POST",success:function(){var t=n.find(".specimen-name").attr("value"),e=n.find(".specimen-path").attr("value");window.saturne.signature.download(e+t,t),$.ajax({url:document.URL+"&action=remove_file&token="+o,type:"POST",success:function(){},error:function(){}})},error:function(){}})},window.saturne.toolbox={},window.saturne.toolbox.init=function(){window.saturne.toolbox.event()},window.saturne.toolbox.getQuerySeparator=function(t){return t.match(/\?/)?"&":"?"};